"use strict";(self.webpackChunkoracle_docs=self.webpackChunkoracle_docs||[]).push([[279],{3409:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"sqlMacro-vs-global-ctx","title":"SQL Macros vs Global Context","description":"SQL Macros vs Global Context","source":"@site/docs-oracle/sqlMacro-vs-global-ctx.md","sourceDirName":".","slug":"/sqlMacro-vs-global-ctx","permalink":"/Oracle-Docs/docs-oracle/sqlMacro-vs-global-ctx","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"sqlMacro-vs-global-ctx","title":"SQL Macros vs Global Context","sidebar_position":4},"sidebar":"oracleSidebar","previous":{"title":"Oralce APEX Global CTX Process Diagram","permalink":"/Oracle-Docs/docs-oracle/oracle-apex-global-ctw-plantuml"},"next":{"title":"EBS R12.2.10, Query to get custom schduled Concurrent Requests","permalink":"/Oracle-Docs/docs-oracle/ebsR12-scheduled-concurrent-requests-checker"}}');var n=t(4848),l=t(8453);const o={id:"sqlMacro-vs-global-ctx",title:"SQL Macros vs Global Context",sidebar_position:4},i=void 0,a={},c=[{value:"SQL Macros vs Global Context",id:"sql-macros-vs-global-context",level:3},{value:"What They Are",id:"what-they-are",level:4},{value:"Capabilities",id:"capabilities",level:4}];function d(e){const s={a:"a",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h3,{id:"sql-macros-vs-global-context",children:"SQL Macros vs Global Context"}),"\n",(0,n.jsx)(s.p,{children:"Quick comparison of SQL Macros and using Global Application Context"}),"\n",(0,n.jsx)(s.h4,{id:"what-they-are",children:"What They Are"}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"SQL Macros"})," are functions defined with ",(0,n.jsx)(s.code,{children:"SQL_MACRO"})," that return SQL text fragments (table or scalar). When you invoke them, Oracle expands them into the outer SQL so optimizer can see the full query. ",(0,n.jsx)(s.a,{href:"https://livesql.oracle.com/ords/livesql/file/tutorial_KQNYERE8ZF07EZMRR6KJ0RNIR.html",children:"livesql.oracle.com"})]}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Global Application Context"})," is an Oracle mechanism to store session/user/tenant-scoped key/value pairs (attributes) that can be set via ",(0,n.jsx)(s.code,{children:"DBMS_SESSION.SET_CONTEXT"})," (in a trusted package), accessed via ",(0,n.jsx)(s.code,{children:"SYS_CONTEXT(namespace, attribute)"}),", and optionally cleared. It works globally (SGA) when created with ",(0,n.jsx)(s.code,{children:"ACCESSED GLOBALLY"}),". (Oracle docs \u201cCreate Context\u201d & \u201cUsing Application Contexts\u201d)."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"capabilities",children:"Capabilities"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Item"}),(0,n.jsx)(s.th,{children:"SQL Macros"}),(0,n.jsx)(s.th,{children:"Global Context"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Where you can use it"})}),(0,n.jsx)(s.td,{children:"In SELECT list, WHERE, ORDER BY. Table macros (FROM clause) only in newer versions (21c+)."}),(0,n.jsx)(s.td,{children:"Anywhere you can call a function. Commonly in WHERE clauses or views."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Reusability"})}),(0,n.jsx)(s.td,{children:"Good for repeating logic inside queries."}),(0,n.jsx)(s.td,{children:"Good for applying the same filter across many queries."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Visibility to optimizer"})}),(0,n.jsx)(s.td,{children:"SQL text changes with macro parameters \u2192 may lead to less cursor sharing if parameters embed new literals. On the other hand, optimizer gets full visibility."}),(0,n.jsx)(s.td,{children:"SQL text stays stable; parameters via context \u2192 better share-able SQL across sessions or requests."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Setup effort"})}),(0,n.jsx)(s.td,{children:"Simple: just create the macro function."}),(0,n.jsx)(s.td,{children:"More steps: create context, trusted package, and initialization logic."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Works in APEX with Ajax/pooling"})}),(0,n.jsx)(s.td,{children:"Limited. Parameters are tied to each query."}),(0,n.jsx)(s.td,{children:"Strong. Context values survive across requests if set per client id."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Constraints"})}),(0,n.jsxs)(s.td,{children:["- Must compile with object references in place. ",(0,n.jsx)("br",{})," - Cannot be nested easily. ",(0,n.jsx)("br",{})," - In 19c only scalar macros exist, no table macros."]}),(0,n.jsxs)(s.td,{children:["- Must set and clear values carefully to avoid leaks. ",(0,n.jsx)("br",{})," - Needs ",(0,n.jsx)(s.code,{children:"CLIENT_IDENTIFIER"})," to link values. ",(0,n.jsx)("br",{})," - Values are case sensitive."]})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"Best for"})}),(0,n.jsx)(s.td,{children:"Reusable expressions, common filter fragments."}),(0,n.jsx)(s.td,{children:"Per-user or per-session filters, multi-tenant apps, APEX with pooled DB sessions."})]})]})]})]})}function h(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>i});var r=t(6540);const n={},l=r.createContext(n);function o(e){const s=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),r.createElement(l.Provider,{value:s},e.children)}}}]);