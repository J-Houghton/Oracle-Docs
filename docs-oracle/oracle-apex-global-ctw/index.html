<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-oracleDocs docs-version-current docs-doc-page docs-doc-id-oracle-apex-global-ctw" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Set and View Global Contexts in APEX and Oracle DB | Some Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://J-Houghton.github.io/Oracle-Docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://J-Houghton.github.io/Oracle-Docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://J-Houghton.github.io/Oracle-Docs/docs-oracle/oracle-apex-global-ctw"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-oracleDocs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-oracleDocs-current"><meta data-rh="true" property="og:title" content="Set and View Global Contexts in APEX and Oracle DB | Some Docs"><meta data-rh="true" name="description" content="Initial Draft, I have an issue where on the very first Page Subimt of run report, the parameter value from APEX page item isn&#x27;t accessable, I suspect this is due to needing before to set context using Page header on the very first load of the page; Will add debug and behavior later, test in your app."><meta data-rh="true" property="og:description" content="Initial Draft, I have an issue where on the very first Page Subimt of run report, the parameter value from APEX page item isn&#x27;t accessable, I suspect this is due to needing before to set context using Page header on the very first load of the page; Will add debug and behavior later, test in your app."><link data-rh="true" rel="icon" href="/Oracle-Docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://J-Houghton.github.io/Oracle-Docs/docs-oracle/oracle-apex-global-ctw"><link data-rh="true" rel="alternate" href="https://J-Houghton.github.io/Oracle-Docs/docs-oracle/oracle-apex-global-ctw" hreflang="en"><link data-rh="true" rel="alternate" href="https://J-Houghton.github.io/Oracle-Docs/docs-oracle/oracle-apex-global-ctw" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Set and View Global Contexts in APEX and Oracle DB","item":"https://J-Houghton.github.io/Oracle-Docs/docs-oracle/oracle-apex-global-ctw"}]}</script><link rel="stylesheet" href="/Oracle-Docs/assets/css/styles.e17ef4d4.css">
<script src="/Oracle-Docs/assets/js/runtime~main.2e4e760d.js" defer="defer"></script>
<script src="/Oracle-Docs/assets/js/main.9a185125.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/Oracle-Docs/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Oracle-Docs/"><div class="navbar__logo"><img src="/Oracle-Docs/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/Oracle-Docs/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Docs</b></a><a class="navbar__item navbar__link" href="/Oracle-Docs/docs/intro">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Oracle-Docs/docs-oracle/oracle-docs-intro">Oracle Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/J-Houghton/Oracle-Docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Oracle-Docs/docs-oracle/oracle-docs-intro">Oracle Docs Intro Page</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Oracle-Docs/docs-oracle/oracle-apex-global-ctw-plantuml">Oralce APEX Global CTX Process Diagram</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/Oracle-Docs/docs-oracle/oracle-apex-global-ctw">Set and View Global Contexts in APEX and Oracle DB</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Oracle-Docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Set and View Global Contexts in APEX and Oracle DB</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><detail>Initial Draft, I have an issue where on the very first Page Subimt of run report, the parameter value from APEX page item isn&#x27;t accessable, I suspect this is due to needing before to set context using Page header on the very first load of the page; Will add debug and behavior later, test in your app. </detail>
<header><h1>Parameterized Views in Oracle 19c+ and APEX 23.1+ Using <strong>Global Application Context</strong></h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-goal">1) Goal<a href="#1-goal" class="hash-link" aria-label="Direct link to 1) Goal" title="Direct link to 1) Goal">​</a></h2>
<p>Create a page/user-specific filters to apply across pooled DB sessions and Ajax requests. Use a <strong>global application context</strong> keyed by a canonical <code>client_id</code>. Query with <code>SYS_CONTEXT</code> in views or SQL, and set/clear context at each APEX request.
<strong>Note:</strong> <em>Before Header</em> and <em>After Regions</em> processes <strong>does not work</strong> for pages&#x27; <strong>Ajax</strong> (no filter/sort/partial refresh) requests. For Ajax or mixed flows, use <strong>Security Attributes → Database Session</strong>.
APEX docs specify per-request Initialization/Cleanup hooks; Before Header runs during page render only.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-why-it-works">2) Why It Works<a href="#2-why-it-works" class="hash-link" aria-label="Direct link to 2) Why It Works" title="Direct link to 2) Why It Works">​</a></h2>
<p>A global context stores attributes in the SGA and exposes them to a session based on <code>CLIENT_IDENTIFIER</code>. <code>SYS_CONTEXT</code> reads the attribute value; <code>DBMS_SESSION.SET_CONTEXT</code> writes it; <code>DBMS_SESSION.CLEAR_CONTEXT</code> removes it. APEX can run Initialization and Cleanup PL/SQL each request, so the same context applies to full submits and Ajax calls.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-prereqs-and-order-of-creation">3) Prereqs and Order of Creation<a href="#3-prereqs-and-order-of-creation" class="hash-link" aria-label="Direct link to 3) Prereqs and Order of Creation" title="Direct link to 3) Prereqs and Order of Creation">​</a></h2>
<ol>
<li>Create the context <strong>first</strong> and bind it to the trusted package.</li>
<li>Create the package that calls <code>DBMS_SESSION.SET_CONTEXT</code> and <code>CLEAR_CONTEXT</code>.</li>
<li>(optional) Grant execute on the package to the APEX parsing schema.</li>
<li>Use a single <code>client_id</code> pattern: <code>:APP_USER || :APP_NAME</code>.<br>
<a href="https://docs.oracle.com/en/database/oracle/oracle-database/23/sqlrf/CREATE-CONTEXT.html" target="_blank" rel="noopener noreferrer">Docs</a> note: only the package named in <code>CREATE CONTEXT ... USING</code> can set attributes.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-create-context-and-trusted-package">4) Create Context and Trusted Package<a href="#4-create-context-and-trusted-package" class="hash-link" aria-label="Direct link to 4) Create Context and Trusted Package" title="Direct link to 4) Create Context and Trusted Package">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-context">4.1 Context<a href="#41-context" class="hash-link" aria-label="Direct link to 4.1 Context" title="Direct link to 4.1 Context">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLACE</span><span class="token plain"> CONTEXT TEST_APP_CTX</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">USING</span><span class="token plain"> test_app_ctx_helper_pkg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ACCESSED GLOBALLY</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<p><code>ACCESSED GLOBALLY</code> enables global scope; the bound package controls writes.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-trusted-package">4.2 Trusted Package<a href="#42-trusted-package" class="hash-link" aria-label="Direct link to 4.2 Trusted Package" title="Direct link to 4.2 Trusted Package">​</a></h3>
<div class="language-plsql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plsql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">CREATE OR REPLACE PACKAGE APPS.test_app_ctx_helper_pkg AUTHID DEFINER AS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PROCEDURE set_parameter_value(p_client_id IN VARCHAR2, p_attr IN VARCHAR2, p_val IN VARCHAR2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PROCEDURE clear_ctx(p_client_id IN VARCHAR2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END test_app_ctx_helper_pkg;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CREATE OR REPLACE PACKAGE BODY APPS.test_app_ctx_helper_pkg AS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PROCEDURE set_parameter_value(p_client_id IN VARCHAR2, p_attr IN VARCHAR2, p_val IN VARCHAR2) IS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		DBMS_SESSION.set_context(namespace =&gt; &#x27;TEST_APP_CTX&#x27;, attribute  =&gt; UPPER(p_attr), value =&gt;  p_val,  username =&gt; null, client_id =&gt; p_client_id);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	END;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	PROCEDURE clear_ctx(p_client_id IN VARCHAR2) IS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		DBMS_SESSION.clear_context(namespace =&gt; &#x27;TEST_APP_CTX&#x27;, client_id =&gt; p_client_id, attribute =&gt; null);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	END;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END test_app_ctx_helper_pkg;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/ </span><br></span></code></pre></div></div>
<p><code>SET_IDENTIFIER</code> ties visibility in <code>GLOBAL_CONTEXT</code> to the <code>client_id</code>. Also uses <code>client_id</code> named parameter in <code>CLEAR_CONTEXT</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-apex-integration-init-and-cleanup">5) APEX Integration (Init and Cleanup)<a href="#5-apex-integration-init-and-cleanup" class="hash-link" aria-label="Direct link to 5) APEX Integration (Init and Cleanup)" title="Direct link to 5) APEX Integration (Init and Cleanup)">​</a></h2>
<p>Put this once per application: <strong>Shared Components → Security Attributes → Database Session</strong>.</p>
<p><strong>Initialization PL/SQL Code</strong></p>
<div class="language-plsql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plsql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DECLARE  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  client_id VARCHAR2(64) := :APP_USER || &#x27;:AppName:XXX&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IF :APP_PAGE_ID = XXX and :PXXX_SalaryIn IS NOT NULL THEN </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      test_app_ctx_helper_pkg.set_parameter_value(client_id,&#x27;PXXX_SalaryIn&#x27;,:PXXX_SalaryIn);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  END IF;  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXCEPTION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHEN OTHERS THEN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        apex_application.g_notIFication := &#x27;*** APEX ERROR &gt; Database Session|Initialization PL/SQL Code: &#x27;||SQLERRM; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END;</span><br></span></code></pre></div></div>
<p><strong>Cleanup PL/SQL Code</strong></p>
<div class="language-plsql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plsql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DECLARE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  client_id VARCHAR2(64) := :APP_USER || &#x27;:AppName:XXX&#x27;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">BEGIN      </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_app_ctx_helper_pkg.clear_ctx(&#x27;client_id123&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- When no attribute is defined, all ctx for that client_id is cleared </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXCEPTION </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WHEN OTHERS THEN </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        apex_application.g_notIFication := &#x27;*** APEX ERROR &gt; Database Session|Cleanup PL/SQL Code: &#x27;||SQLERRM;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">END;</span><br></span></code></pre></div></div>
<p>These attributes run at the start and end of every APEX request, including Ajax.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-minimal-verification-db-apex-page-ajax">6) Minimal Verification (DB, APEX Page, Ajax)<a href="#6-minimal-verification-db-apex-page-ajax" class="hash-link" aria-label="Direct link to 6) Minimal Verification (DB, APEX Page, Ajax)" title="Direct link to 6) Minimal Verification (DB, APEX Page, Ajax)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-db-block">6.1 DB block<a href="#61-db-block" class="hash-link" aria-label="Direct link to 6.1 DB block" title="Direct link to 6.1 DB block">​</a></h3>
<div class="language-plsql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plsql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">-- No other set up needed, use to test context and pkg. </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BEGIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DBMS_OUTPUT.PUT_LINE(&#x27;=== BEGIN ===&#x27;); </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        test_app_ctx_helper_pkg.set_parameter_value(&#x27;client_id123&#x27;,&#x27;ATTRIBUTEIN&#x27;,&#x27;valueIN&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DBMS_OUTPUT.PUT_LINE( SYS_CONTEXT(&#x27;TEST_APP_CTX&#x27;,&#x27;ATTRIBUTEIN&#x27;) );  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        FOR r IN (SELECT namespace, attribute, value FROM GLOBAL_CONTEXT) LOOP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          DBMS_OUTPUT.PUT_LINE(r.namespace||&#x27;:&#x27;||r.attribute||&#x27;=&#x27;||r.value);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        END LOOP;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        test_app_ctx_helper_pkg.clear_ctx(&#x27;client_id123&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DBMS_OUTPUT.PUT_LINE(&#x27;==== END ====&#x27;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    END; </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- Expected DBMS Out</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- === BEGIN ===</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- valueIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- TEST_APP_CTX:ATTRIBUTEIN=valueIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -- ==== END ====</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-parameterized-view--apex-page-item">6.2 Parameterized view + APEX page item<a href="#62-parameterized-view--apex-page-item" class="hash-link" aria-label="Direct link to 6.2 Parameterized view + APEX page item" title="Direct link to 6.2 Parameterized view + APEX page item">​</a></h3>
<div class="language-sql codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sql codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">REPLACE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">VIEW</span><span class="token plain"> Custom_HR_CTX_V </span><span class="token keyword" style="color:#00009f">AS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain">   hr</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">employees e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain">  e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">salary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> TO_NUMBER</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SYS_CONTEXT</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;CUSTOM_APP_CTX&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&#x27;P_SALARY_IN&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><br></span></code></pre></div></div>
<p>Use the view in a Classic/IR region: <code>SELECT * FROM CUSTOM_APP_CTX</code>. On report run or page submit should provide/save <code>P10_SALARY_IN</code>&#x27;s value in DB sessison.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-ajax-check">6.3 Ajax check<a href="#63-ajax-check" class="hash-link" aria-label="Direct link to 6.3 Ajax check" title="Direct link to 6.3 Ajax check">​</a></h3>
<p>Filter or Sort the Classic/IR region. The Initialization PL/SQL runs each Ajax request, so the same context value is read by the view.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="64-execution-flow">6.4 Execution Flow<a href="#64-execution-flow" class="hash-link" aria-label="Direct link to 6.4 Execution Flow" title="Direct link to 6.4 Execution Flow">​</a></h3>
<ol>
<li><strong>Page Submit</strong>
<ul>
<li>APEX collects submitted items and request context.</li>
</ul>
</li>
<li><strong>Init PL/SQL Code</strong>
<ul>
<li>Application logic runs at page submit or process level.</li>
<li>Example: setting identifiers for correlation.</li>
</ul>
</li>
<li><strong>Set Context Values</strong>
<ul>
<li><code>DBMS_SESSION.SET_IDENTIFIER</code> → assign <code>client_id</code>.</li>
<li><code>DBMS_SESSION.SET_CONTEXT</code> → assign <code>P10_Salary_In</code> = <code>clientValue</code>.</li>
</ul>
</li>
<li><strong>SQL Execution</strong>
<ul>
<li>APEX executes queries.</li>
<li>Context-sensitive logic applied with <code>SYS_CONTEXT</code> lookups.</li>
</ul>
</li>
<li><strong>Filter from Global Context</strong>
<ul>
<li>Query predicates reference values in <strong>application/global context</strong>.</li>
<li>Enforced in VPD, RLS, or explicit WHERE clauses.</li>
</ul>
</li>
<li><strong>Return Data to APEX</strong>
<ul>
<li>Results mapped back to APEX page items or regions.</li>
</ul>
</li>
<li><strong>Clean Up PL/SQL Code</strong>
<ul>
<li>Optional <code>DBMS_SESSION.CLEAR_CONTEXT</code> or reset of identifiers.</li>
<li>Ensures no leakage across pooled sessions.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="7-performance-and-simplification-note">7) Performance and Simplification Note<a href="#7-performance-and-simplification-note" class="hash-link" aria-label="Direct link to 7) Performance and Simplification Note" title="Direct link to 7) Performance and Simplification Note">​</a></h2>
<p><code>SYS_CONTEXT</code> is a SQL function and can be used in <code>WHERE</code> clauses and views. Apply normal indexing on filtered columns. Evaluate plan as usual with <code>EXPLAIN PLAN</code> or AWR tools. No Oracle claim of special behavior beyond standard predicate evaluation.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-troubleshooting">8) Troubleshooting<a href="#8-troubleshooting" class="hash-link" aria-label="Direct link to 8) Troubleshooting" title="Direct link to 8) Troubleshooting">​</a></h2>
<ol start="0">
<li>
<p>Use <code>SELECT * FROM V$GLOBALCONTEXT;</code> to view all Global Context in DB, can also inspect <code>CLIENT_IDENTIFIER</code> via <code>V$SESSION</code>.</p>
</li>
<li>
<p><strong>ORA-01031</strong> while setting context: ensure calls run <strong>inside</strong> the package named in <code>CREATE CONTEXT ... USING</code>. Create context first, then package. (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/23/sqlrf/CREATE-CONTEXT.html" target="_blank" rel="noopener noreferrer">CREATE_CONTEXT Doc</a>)</p>
</li>
<li>
<p><strong>Not visible in <code>GLOBAL_CONTEXT</code></strong>: set <code>CLIENT_IDENTIFIER</code> (either in your setter or earlier in the request). (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/GLOBAL_CONTEXT.html" target="_blank" rel="noopener noreferrer">GLOBAL_CONTEXT Doc</a>)</p>
</li>
<li>
<p><strong>Ajax didn’t pick up value</strong>: put logic in <strong>Security Attributes → Database Session → Initialization PL/SQL Code</strong>, not in a page “Before Header” process. Before Header is only ran on Page Submit.</p>
</li>
<li>
<p><strong>Case sensitivity</strong>: <code>client_id</code> and attribute names are case-sensitive where documented; use <code>UPPER</code> for attributes consistently.</p>
</li>
<li>
<p><strong>Changing <code>CLIENT_IDENTIFIER</code> in APEX.</strong>  <a href="https://docs.oracle.com/en/database/oracle/apex/24.1/htmdb/correlating-apex-sessions-to-database-sessions.html#GUID-3758CB03-6837-470E-A099-23387D9DC386" target="_blank" rel="noopener noreferrer">APEX Docs</a>, section D.2, client_info, paragraph 2:
<code>Within an APEX session, setting this attribute is not necessary and generally should be left unchanged. If custom PL/SQL code executed within an APEX session changes client_id, this change will not cause problems for Oracle APEX. However, it may affect the ability for some monitoring tools to effectively identify the APEX session.</code></p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="9-references">9) References<a href="#9-references" class="hash-link" aria-label="Direct link to 9) References" title="Direct link to 9) References">​</a></h2>
<ul>
<li>
<p><strong>Global Application Context visibility</strong>: <em>Database Reference 19c → GLOBAL_CONTEXT</em>. (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/refrn/GLOBAL_CONTEXT.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
<li>
<p><strong>Using Application Contexts</strong>: <em>Security Guide 19c → Using Application Contexts</em>. (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/dbseg/using-application-contexts-to-retrieve-user-information.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
<li>
<p><strong>DBMS_SESSION</strong>: <em>PL/SQL Packages and Types 19c → DBMS_SESSION</em> (<code>SET_CONTEXT</code>, <code>SET_IDENTIFIER</code>, <code>CLEAR_CONTEXT</code>). (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/19/arpls/DBMS_SESSION.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
<li>
<p><strong>CREATE CONTEXT</strong>: <em>SQL Language Reference</em> (context binding to package; global access). (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/23/sqlrf/CREATE-CONTEXT.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
<li>
<p><strong>SYS_CONTEXT</strong>: <em>SQL Language Reference</em> (function usage in SQL/PLSQL). (<a href="https://docs.oracle.com/en/database/oracle/oracle-database/23/sqlrf/SYS_CONTEXT.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
<li>
<p><strong>APEX request hooks</strong>: <em>APEX 23.1 Dev Guide → Configuring Security Attributes → Database Session</em>. (<a href="https://docs.oracle.com/en/database/oracle/apex/23.1/htmdb/configuring-security-attributes.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
<li>
<p><strong>APEX session correlation</strong>: <em>APEX 24.1 Dev Guide → Correlating APEX Sessions to Database Sessions</em>. (<a href="https://docs.oracle.com/en/database/oracle/apex/24.1/htmdb/correlating-apex-sessions-to-database-sessions.html" target="_blank" rel="noopener noreferrer">Oracle Documentation</a>)</p>
</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/Oracle-Docs/docs-oracle/oracle-apex-global-ctw-plantuml"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Oralce APEX Global CTX Process Diagram</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-goal" class="table-of-contents__link toc-highlight">1) Goal</a></li><li><a href="#2-why-it-works" class="table-of-contents__link toc-highlight">2) Why It Works</a></li><li><a href="#3-prereqs-and-order-of-creation" class="table-of-contents__link toc-highlight">3) Prereqs and Order of Creation</a></li><li><a href="#4-create-context-and-trusted-package" class="table-of-contents__link toc-highlight">4) Create Context and Trusted Package</a><ul><li><a href="#41-context" class="table-of-contents__link toc-highlight">4.1 Context</a></li><li><a href="#42-trusted-package" class="table-of-contents__link toc-highlight">4.2 Trusted Package</a></li></ul></li><li><a href="#5-apex-integration-init-and-cleanup" class="table-of-contents__link toc-highlight">5) APEX Integration (Init and Cleanup)</a></li><li><a href="#6-minimal-verification-db-apex-page-ajax" class="table-of-contents__link toc-highlight">6) Minimal Verification (DB, APEX Page, Ajax)</a><ul><li><a href="#61-db-block" class="table-of-contents__link toc-highlight">6.1 DB block</a></li><li><a href="#62-parameterized-view--apex-page-item" class="table-of-contents__link toc-highlight">6.2 Parameterized view + APEX page item</a></li><li><a href="#63-ajax-check" class="table-of-contents__link toc-highlight">6.3 Ajax check</a></li><li><a href="#64-execution-flow" class="table-of-contents__link toc-highlight">6.4 Execution Flow</a></li></ul></li><li><a href="#7-performance-and-simplification-note" class="table-of-contents__link toc-highlight">7) Performance and Simplification Note</a></li><li><a href="#8-troubleshooting" class="table-of-contents__link toc-highlight">8) Troubleshooting</a></li><li><a href="#9-references" class="table-of-contents__link toc-highlight">9) References</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Oracle-Docs/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">List 1</div><ul class="footer__items clean-list"><li class="footer__item"><a href="#" class="footer__link-item">Item 1</a></li><li class="footer__item"><a href="#" class="footer__link-item">Item 2</a></li><li class="footer__item"><a href="#" class="footer__link-item">Item 3</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">List 2</div><ul class="footer__items clean-list"><li class="footer__item"><a href="#" class="footer__link-item">Item 1</a></li><li class="footer__item"><a href="https://github.com/J-Houghton/Oracle-Docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 J-Houghton, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>